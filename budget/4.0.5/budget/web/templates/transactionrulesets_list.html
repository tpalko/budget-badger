{% extends "base.html" %}
{% load budget_tags %}

{% block content %}

{% if message %}
<div>
    {{ message }}
</div>
{% endif %}

<div class="row">
    <div class="col-9">
        <div id="transactionruleset_form">
            {% include "transactionruleset_edit.html" %}
        </div>
        {% for transactionruleset in transactionrulesets %}
        <div>
            <h3>{{ transactionruleset.name }} - {{ transactionruleset.transactionrules.all|length }} rules</h3>
            <h4>{{ transactionruleset.records|length }} Records -> {{ transactionruleset.transaction }}</h4>
            <h4>
                <div>{{ transactionruleset.join_operator }}</div>
            </h4>
            <div>
                {% for transactionrule in transactionruleset.transactionrules.all %}
                    <div>
                        #{{ forloop.counter }}. {{ transactionrule.record_field }} {{ transactionrule.match_operator }} {{ transactionrule.match_value}}            
                    </div>
                {% endfor %}
            </div>
            
            <div>
                <a href="{%  url "transactionruleset_edit" tenant_id=1 transactionruleset_id=transactionruleset.id %}">edit</a>
                <a href="{%  url "transactionruleset_edit" tenant_id=1 transactionruleset_id=transactionruleset.id %}" class="delete">delete</a>
            </div>        
        </div>
    {% endfor %}
    </div>
    <div class="col-7">
        <a href="{% url "transaction_bulk" tenant_id=1 %}">Bulk Intake</a>
        <a href="{% url "regroup_records" tenant_id=1 %}">Regroup Records</a>
        {% if recordgroup_data.record_groups %}
        <table class="clicky-table" id="record_group_table">
            <tr class="row">
                {% for column in recordgroup_data.record_group_columns|array_split:',' %}
                    <th>{{ column }}</th>
                {% endfor %}
            </tr>
            {% for record_group in recordgroup_data.record_groups %}
            <tr id="recordgroup-{{ forloop.counter0 }}" class="{% if forloop.counter0|mod:2 == 0 %}even{% else %}odd{% endif %}">
                {% for column in recordgroup_data.record_group_columns|array_split:',' %}
                    <td data-clickyrow="recordgroup-{{ forloop.parentloop.counter0 }}">{{ record_group|lookup:column }}</td>
                {% endfor %}                
            </tr>
            {% endfor %}
        </table>
        {% endif %}
    </div>
</div>


{% endblock %}

{% block script %}

<script language="javascript">

    


</script>

{% endblock %}